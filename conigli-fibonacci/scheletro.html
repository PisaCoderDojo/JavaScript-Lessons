<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta charset="UTF-8">
  <style>
    canvas {
      border: 1px solid #d3d3d3;
      background-image: url('grass.jpg');
      cursor:url(bacchetta.cur), auto;
    }

  </style>
</head>

<script>
  
/**
* Completa il codice
**/
    
  const FRAME_RATE = 20;
  const WIDTH = 800;
  const HEIGHT = 500;
  const SEC_MESE = 0.5;
  const MAX_COPPIE = 100;
  const MAX_MESE = 14;

  var imgConiglio = new Image();
  imgConiglio.src = 'rabbit.png';

  var conigli = [];
  var mese = 0;
  
  var isPausa = true;

  function startGame() {
    
    // inizializza il gioco

    areaGioco.updateGameArea = updateGame;
    areaGioco.start();
  }

  function updateGame() {
    if(!isPausa) {
		if (isMese()) {
			if (mese < MAX_MESE){
				mese = mese + 1;
			}
	
		  // fa maturare i conigli
	
		  // crea nuove coppie di conigli
            
		}
		
		areaGioco.clear();
		conigli.forEach(coniglio => {
		  coniglio.update();
		  coniglio.draw();
		});
		scriviTesto();
    }
  }
    
  function contaCoppie(){
      
      // conta il numero di coppie adulte
      
  }
      
  function scriviTesto() {
      
      // scrivi il numero di coppie ed il mese su schermo
      
    }


  class Coniglio {
    constructor() {
      this.x = random(80, WIDTH - 80);
      this.y = random(80, HEIGHT - 80);
      this.velX = random(-4, 4);
      this.velY = random(-4, 4);
      this.size = 10
      this.age = 0;
    }
    draw() {
      
      // disegna il coniglio sullo schermo
        
    }
    update() {

      // aumenta le dimensioni del coniglio  
      
        
      // fai muovere il coniglio nello schermo 

  }
      
  /**
  * Funzioni sfida
  **/
  
  function riavviaGioco(){
      
      // aggiungi la possibilita di restartare
      
  }
  
  class Puff {
    
      // aggiungi effetti speciali!
      
  }

  // sperimenta con i parametri ed aggiungi altro codice! Sempre in gamba! ;)    
    

  /**
   * Funzioni di libreria
   **/
      
  function isMese() {
    var frameMese = (SEC_MESE * 1000) / FRAME_RATE
    if (areaGioco.frameNum % frameMese == 0) {
      return true;
    } else {
      return false;
    }
  }
  var areaGioco = {
    canvas: document.createElement("canvas"),
    start: function () {
      this.canvas.width = WIDTH;
      this.canvas.height = HEIGHT;
      this.context = this.canvas.getContext("2d");
      document.body.insertBefore(this.canvas, document.body.childNodes[0]);
      this.frameNum = 0;
      this.interval = setInterval(() => {
        this.updateGameArea();
        this.frameNum++;
      }, FRAME_RATE);
      this.canvas.addEventListener('click', this.onClick);
    },
    clear: function () {
      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    },
    updateGameArea: function () {},
    onClick: function() {}
  }
  
  areaGioco.canvas.addEventListener("click",function(e) {

    const intersecato = (punto, cerchio) => {
      return Math.sqrt((punto.x - cerchio.x) ** 2 + (punto.y - cerchio.y) ** 2) < cerchio.size;
    }

    const posizioneMouse = {
      x: e.clientX,
      y: e.clientY
    };
	if(!isPausa) {
	  for (var i = 0; i < conigli.length; i++) {
		if (intersecato(posizioneMouse, conigli[i])) {
			conigli.splice(i, 1);
			break;
		}
	  }
	}
  });
  
  function togglePausa(){
    if (!isPausa){
        isPausa = true;
    } else if (isPausa){
       isPausa = false;
    }
  };
  
  window.addEventListener("keydown",function (e){
	var key = e.keyCode;
	if (key == 80 || key == 13){
		togglePausa();
	}
  });
  
  function random(min, max) {
    var num = Math.floor(Math.random() * (max - min)) + min;
    return num;
  };

	
</script>

<body onload="startGame()">
  <br>

  <h1>Conigli di Fibonacci</h1>
  <p>L'intento di Leonardo Fibonacci era quello di trovare una legge matematica che descrivesse la crescita di una
    popolazione di conigli.</p>

  <p>Assumendo per ipotesi che:</p>
  <ul>
    <li> si disponga di una coppia di conigli appena nati
    </li>

    <li>questa coppia (la prima) diventi adulta al compimento del primo mese e dia alla luce una nuova coppia al
      compimento del secondo mese;</li>
    <li>le nuove coppie nate si comportino in modo analogo;</li>
    <li>le coppie adulte, dal secondo mese di vita in poi, diano alla luce una coppia di figli al mese;</li>
  </ul>
  <p>si verifica quanto segue:</p>
  <ul>
    <li>dopo un mese una coppia di conigli sarà adulta,
    </li>
    <li>dopo due mesi ci saranno due coppie di cui una sola adulta,
    </li>
    <li>nel mese seguente (terzo mese dal momento iniziale) ci saranno 2+1=3 coppie perché solo la coppia adulta avrà
      generato; di queste tre due saranno le coppie adulte, quindi</li>
    <li>nel mese seguente (quarto mese dal momento iniziale) ci saranno 3+2=5 coppie</li>
    <li>In questo esempio, il numero di coppie di conigli di ogni mese esprime la successione di Fibonacci.</li>
  </ul>

  <p>Testo da <a href="https://it.wikipedia.org/wiki/Successione_di_Fibonacci">Wikipedia</a></p>
</body>

</html>
